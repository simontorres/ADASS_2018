% super simple template for automated 2018 ADASS manuscript generation from the registration entry
% most comments have been removed, see the ADASS_template.tex for a fully commented version

% Version 4-nov-2018 (Peter Teuben)

\documentclass[11pt,twoside]{article}
\usepackage{asp2014}

\aspSuppressVolSlug
\resetcounters

\bibliographystyle{asp2014}


\markboth{Torres-Robledo, and Brice\~no}{An on-site data reduction pipeline for the Goodman Spectrograph}      % remove/add authors as you need

\begin{document}

\title{An on-site data reduction pipeline for the Goodman Spectrograph}


\author{Sim\'on~Torres-Robledo,$^1$ and C\'esar~Brice\~no$^{1,2}$
  \affil{$^1$SOAR Telescope, La Serena, Regi\'on de Coquimbo, Chile; \email{storres@ctio.noao.edu}}
  \affil{$^2$Cerro Tololo Interamerican Observatory, Casilla 603, La Serena, Chile}}           % remove/add authors as you need


\paperauthor{Sim√≥n~Torres-Robledo}{storres@ctio.noao.edu}{ORCID}{SOAR Telescope}{Author1 Department}{La Serena}{Regi\'on de Coquimbo}{Postal Code}{Chile}
% remove/add authors as you need
\paperauthor{C\'esar~Brice\~no}{cbriceno@ctio.noao.edu}{ORCID_Or_Blank}{SOAR Telescope}{Author2 Department}{La Serena}{Regi\'on de Coquimbo}{Postal Code}{Chile}

% leave these commented for the editors to enable them
%\aindex{Torres,~S.}
%\aindex{Brice\~no,~C.}          % remove and add as you need
  
\begin{abstract}

The Goodman Spectroscopic Pipeline (GSP) is reaching some maturity and
behaving in a stable manner. Though its development continues, we have
started a parallel effort to develop a real-time version of the GSP,
which aims at obtaining fully reduced data within seconds after the spectrum
has been obtained at the telescope.  Most of the required structure, algorithms and
processes already exist with the offline version of the GSP. The real-time or online
version differs in its requirements for flow control, calibration files, image combination, reprocessing, observing logging assistance, etc.
Here we present an outline of the route for implementation of a real time online version.
  
\end{abstract}

\section{Introduction}

The \emph{SOAR Telescope} is a 4-meter telescope located on Cerro Pach\'on, northern Chile. The \emph{Goodman High Throughput Spectrograph} (Goodman HTS) is an Imaging Spectrograph developed by the University of North Carolina, see \citet{2004SPIE.5492..331C}. Is the most requested/used instrument currently at the telescope with about 65\% of the time available on the sky. There is also another team working on an API and a Front End aimed to provide remote pseudo-automatic observation capability. This work focuses on data reduction and quick visualization.


\section{Status of development}


Our offline data reduction pipeline works on a two-step process. \verb=redccd= does the basic CCD data reduction, common for Imaging and Spectroscopy. \verb=redspec= does spectroscopic-specific data reduction.

\section{Design Constraints}

For the live data reduction pipeline we want to get rid of the VNC system and move to a web-based service, this adds a whole new level of complexity but the results are worth the effort, the offline version of the pipeline exists as a single Python package but for the live version  we will need several other components.

\subsection{Data Reduction Package}

This is based on the offline Python package. The modifications required are intended to enable asynchronous data processing as well as controls, this could be achieved by adding a private REST API that would allow to modify the pipeline's settings needed to operate under different observing strategies, it has to be relatively simple and able to work independently and automatically allowing intervention by request from the Public API, the allowed control hooks in the private API should be minimal such as authentication is not required, though the access should be constrained to the Observatory's private network. Some of the controls that should be included are: turn on or off file system event watching routines, alter settings, report errors. It should also handle a light database for redundancy in case the web server fails.

In terms of data processing itself most of the routines are already implemented in the offline version but there are a couple of things that are still unimplemented such as optimal extraction [\citet{1989PASP..101.1032M},  \citet{1986PASP...98..609H}], flux calibration, deblending of multiple sources, low signal-to-noise extraction.

As is explained in \citet{P9-115_adassxxvii}, our philosophy is to rely as much as possible on Astropy's code   [\citet{2013A&A...558A..33A} and \citet{2018AJ....156..123A}] therefore, some of the code that we had to develop because they were not implemented in Astropy will be replaced when they become available or even better we will add them to the appropriate Astropy Package.

\subsection{Public REST API}
Publishing a web application is not a simple task with security been the biggest point of concern but the application has to be stable and reliable as well. Lucky for us there are plenty of tools that allow us to simplify these tasks, maybe too many of them. Since we don't have the resources to hire an entire team of developers already experts on these very specific tools, we will have to do it with the resources we have. The scope of the services provided by the public API should be end user oriented only, such as, secure authentication as well as channeling communications with the private API.

\subsection{Web Front End}
A highly responsive website will be favored over local GUI for one simple reason: Most of the Goodman HTS users are working remotely. Though is more difficult to implement there are several benefits that comes with it, for instance: adaptive layout, user experience less dependant on connection quality, less bandwidth usage and of course taking advantage of the interactive experience that web technology allows.

We have not decided what are the tools (stack) that we are going to use, but the criteria for selecting them are: Have to be well documented and easily testable, by \emph{easily} we mean that there have to be good tools and a good testing philosophy behind its development. Testability is highlighted here but it applies to all the code of our project.


\acknowledgements

The authors would like to acknowledge the important contribution from Bruno Quint, David Sanmartim and Tina Armond.

This research made use of Astropy, a community-developed core Python package for Astronomy [\citet{2013A&A...558A..33A} and \citet{2018AJ....156..123A}] 

This work has been developed at the Southern Astrophysical Research (SOAR) telescope, which is a joint project of the Minist\'erio da Ci\^encia, Tecnologia, Inova\c{c}\~ao e Comunica\c{c}\~oes (MCTIC) do Brasil, the U.S. National Optical Astronomy Observatory (NOAO), the University of North Carolina at Chapel Hill (UNC), and Michigan State University (MSU). 

\section{References}

\bibliography{P4-18}

\end{document}

